{% load static   %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户注册</title>
    <link rel="stylesheet" href="{% static 'register/11.css' %}">
    <link rel="stylesheet" href="{% static 'register/22.css' %}">
    <script>
        function checkpw(){
        if (a.value != b.value)
        alert("两次密码不一样")

        }
    </script>
</head>

<body>
    <div class="wrap login_wrap">
        <div class="content">

            <div class="logo"></div>

            <div class="login_box">

                <div class="login_form">
                    <div class="login_title">
                        注册
                    </div>
                    <form action="/user/reg" method="post">

                        <div class="form_text_ipt">
                            <input id="c" name="username" type="text" placeholder="用户名" required onblur="checkusername()">
                        </div>
                        <div id="d" class="form_text_ipt" style="display: none">
                            <p>
                                error username
                            </p>

                        </div>
                        <div class="form_text_ipt">
                            <input id="a" name="password1" type="password" placeholder="密码" required minlength="6" >
                        </div>

                        <div class="form_text_ipt">
                            <input id="b"  name="password2" type="password" placeholder="重复密码" required minlength="6" onblur="checkpw()">
                        </div>



                        <div class="form_btn">
                            <!-- <button type="button" onclick="javascript:window.location.href='#'">登录</button> -->
                            <input class="reg" type="submit" value="注册">
                        </div>
                        <div class="form_reg_btn">
                            <span>已有帐号？</span><a href="/user/login">马上登录</a>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>

    <div style="text-align:center;">

    </div>
</body>
<script src="/static/jquery-3.6.0.min.js"></script>
<script>
  function checkusername(){
      un=c.value
       $.ajax(
        {
            url:"/user/ajaxtest",
            type:"get",
            data:{
                username:un
            },
            success:function (res){
                console.log(res)
                console.log(typeof (res))
                console.log(typeof (res.msg))
                if(res.msg=="no"){
                    console.log("可用");
                    $("#d").css('display','none')
                }
                 if(res.msg=="ok"){
                    console.log("不可用");
                    $("#d").css('display','block')
                }

            }
        }
    )
  }

</script>
</html>